---
title: "Stretch01"
author: "Ming & Huixin"
format: html
editor: visual
---

## Quarto

Quarto enables you to weave together content and executable code into a finished document. To learn more about Quarto see <https://quarto.org>.

## Running Code

When you click the **Render** button a document will be generated that includes both content and the output of embedded code. You can embed code like this:

```{r}
library(readr)
library(tidyverse)
data <- read_csv("Virginia_Employment_Status_of_the_Population_by_Sex_by_Race_and_by_Age_by_Year.csv")
```

Graph 1 
```{r}
data %>%
  filter(PopulationGroup == "Total") %>%
  ggplot() +
  geom_line(aes(x = Year,
                y = CivilianLaborForce,
                color = "Labor force")) +
  geom_line(aes(x = Year,
                y = CivilianNonInstitutionalPopulation,
                color = "Population")) +
  scale_color_manual("", 
                     values = c(
    "Labor force" = "red",
    "Population" = "blue")) +
  labs(y = "The number of people (thousand)",
       title = "Difference Between Labor Force and Population",
       subtitle = "The increase of labor force fluctuates, while total population increases steadily in Virginia.",
       caption = "Source: data.virginia.gov")
```

Graph2 
```{r}
data %>%
  filter(GroupCode == "01") %>%
  ggplot(aes(x = Year,
             y = CivilianLaborForceUnemployedPercentOfPopulation)) +
  geom_text(aes(label = CivilianLaborForceUnemployedPercentOfPopulation),
            vjust = 2,
            nudge_x = 0.1) +
  geom_line() +
  geom_point() +
  scale_y_continuous(limits = c(1,8)) +
labs(title = "Virginia's Unemployment Rate Fluctuates around 5% in Recent Years",
     subtitle = "Unemployment rate in Virginia increased dramatically in 2020, probably due to the pandemic.",
       caption = "Source: data.virginia.gov",
       x = "Year",
       y = "Unemployment Rate (%)")

```
Graph3 
```{r}
data %>%
  filter(PopulationGroup == "Asian" | PopulationGroup == "Black or African American" |
           PopulationGroup == "White" |
           PopulationGroup == "Hispanic or Latino ethnicity") %>%
  filter(Year >= 2016) %>%
  ggplot() +
  geom_col(aes(x = Year,
               y = CivilianLaborForceUnemployedPercentOfPopulation,
               fill = PopulationGroup),
           position = "dodge") +
  scale_fill_manual(values = c("blue","light blue","purple","pink")) +
  labs(y = "Unemployment rate (%)", 
       title = "Unemployment Rate among African American Is Normally the Highest",
       subtitle = "Unemployment rate among minority groups has been higher than among white people in the past 5 years in Virginia.",
       caption = "Source: data.virginia.gov")
```